<div class="container">
  <ol class="breadcrumb">
    <li><%= link_to 'Home', root_path %></li>
    <li><%= link_to 'Results applications', results_apps_path %></li>
    <li class="active">Results application</li>
  </ol>
</div>

<%= render 'info' %>

<%
  input_file_ids = @results_app.results_app_input_files.select(:results_app_connector_file_id)
  remainig_files = @results_app.results_app_connector.results_app_connector_files.where.not(id: input_file_ids)

  input_param_ids = @results_app.results_app_input_parameters.select(:results_app_connector_parameter_id)
  remainig_params = @results_app.results_app_connector.results_app_connector_parameters.where.not(id: input_param_ids)

=begin
  file_ids.each do |file|
    puts file.id
  end
=end
%>



<div class="container">
  <%= link_to 'Edit', edit_results_app_path(@results_app), :class => "btn btn-warning" %>
  <%# link_to 'Add Input Parameter',new_results_app_input_file_path(@results_app), :class => "btn btn-success"%>
</div>

<div class="container">
  <p>
    <h2>Input files
    <% if !remainig_files.empty? %>
        <%= link_to 'Add Input File',new_results_app_results_app_input_file_path(@results_app), :class => "btn btn-success"%>
    <%end%>
    </h2>
    <div class="media">
      <%if @results_app.results_app_input_files.empty?%>
        <div class="alert alert-warning">
          Currently no input files are registered with this results application.
        </div>
      <%else%>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h4>Results application input files</h4>
          </div>
          <div class="media">
            <table class="table table-hover">
              <thead>
              <tr>
                <th>#</th>
                <th>File type</th>
                <th>File name</th>
                <th colspan="3"></th>
              </tr>
              </thead>

              <tbody>
              <% i = 1 %>
              <% @results_app.results_app_input_files.each do |input_file| %>
                  <tr>
                    <td><%= i %></td>
                    <td><%= input_file.results_app_connector_file.name%></td>
                    <td><%= input_file.filename%></td>
                    <td><%= link_to 'Show', results_app_results_app_input_file_path(@results_app,input_file), class: "btn btn-xs btn-default"%></td>
                    <td><%= link_to 'Edit', edit_results_app_results_app_input_file_path(@results_app,input_file), class: "btn btn-xs btn-warning" %>
                    <td><%= link_to 'Destroy', results_app_results_app_input_file_path(@results_app,input_file), method: :delete, class: "btn btn-xs btn-danger", data: { confirm: 'Are you sure?' } %></td>
                  </tr>
                  <% i = i + 1 %>
              <% end %>
              </tbody>
            </table>
          </div>
        </div>
      <%end%>
    </div>
  </p>
</div>

<div class="container">
  <p>
  <h2>Input parameters
    <% if !remainig_params.empty? %>
        <%= link_to 'Add Input Parameter',new_results_app_results_app_input_parameter_path(@results_app), :class => "btn btn-success"%>
    <%end%>
  </h2>

  <div class="media">
    <%if @results_app.results_app_input_parameters.empty?%>
        <div class="alert alert-warning">
          Currently no input parametaers are registered with this results application.
        </div>
    <%else%>
      <div class="panel panel-default">
        <div class="panel-heading">
          <h4>Results application input parameters</h4>
        </div>
        <div class="media">
          <table class="table table-hover">
            <thead>
            <tr>
              <th>#</th>
              <th>Parameter type</th>
              <th>Parameter value</th>
              <!--TODO If the parameter value is something like a password modify not to dispaly the value -->
              <th colspan="3"></th>
            </tr>
            </thead>

            <tbody>
            <% i = 1 %>
            <% @results_app.results_app_input_parameters.each do |input_param| %>
                <tr>
                  <td><%= i %></td>
                  <td><%= input_param.results_app_connector_parameter.name%></td>
                  <td><%= input_param.value%></td>
                  <td><%= link_to 'Show', results_app_results_app_input_parameter_path(@results_app,input_param), class: "btn btn-xs btn-default"%></td>
                  <td><%= link_to 'Edit', edit_results_app_results_app_input_parameter_path(@results_app,input_param), class: "btn btn-xs btn-warning" %>
                  <td><%= link_to 'Destroy', results_app_results_app_input_parameter_path(@results_app,input_param), method: :delete, class: "btn btn-xs btn-danger", data: { confirm: 'Are you sure?' } %></td>
                </tr>
                <% i = i + 1 %>
            <% end %>
            </tbody>
          </table>
        </div>
      </div>
    <%end%>
  </div>
  </p>
</div>


